---
import { renderRichText } from '@storyblok/js';

const { blok } = Astro.props;
const hasLink = !!(blok.outlet && blok.url);
const dateTxt = blok.date ? new Date(blok.date).toLocaleDateString('es-ES', { year:'numeric', month:'short', day:'2-digit' }) : null;
---

<article class="text-base leading-relaxed">
  <!-- Cita con comillas tipográficas, alineación y tono similar -->
  <p class="italic text-gray-900">
            {(() => {
            try {
                const renderedRichText = renderRichText(blok.review);
                return <Fragment set:html={renderedRichText} />;
            } catch (error) {
                console.error("Error rendering rich text:", error);
                return <p>{JSON.stringify(blok.review)}</p>;
            }
        })()}
  </p>

  <!-- Firma: Autor — Medio (enlace), fecha opcional -->
  <p class="mt-3 text-[0.95rem] text-gray-800">
    {blok.author && <span class="font-medium">{blok.author}</span>}
    {hasLink || blok.mediaOutlet ? (
      <>
        <span> — </span>
        <a href={blok.url} target="_blank" rel="noopener noreferrer" class=" underline-offset-2 hover:underline">
          {blok.mediaOutlet}
        </a>
      </>
    ) : (
      blok.outlet && <> — <span>{blok.outlet}</span></>
    )}
    {dateTxt && <span class="text-gray-500"> · {dateTxt}</span>}
  </p>

  <!-- Separador “* * *” centrado, como en la página original -->
  <div class="select-none mt-6 flex items-center justify-center" aria-hidden="true">
    <span class="text-gray-400">* * *</span>
  </div>
</article>
